Data Science Homework 5
================

### Problem 1

``` r
file_names <- list.files("./data/", full.names = TRUE)

df <- file_names %>% 
  map(read_csv)

for (i in 1:20) {
  if (i < 11) {
    df[[i]] <- df[[i]] %>% 
    mutate(arm = "Control", 
           study_id = i)
  } else if (i > 10) {
    df[[i]] <- df[[i]] %>% 
      mutate(arm = "Experimental", 
             study_id = i - 10)
  }
}

df <- bind_rows(df) %>% 
  gather(key = week, value = obs, week_1:week_8) %>% 
  arrange(week, study_id) %>% 
  separate(col = week, into = c("delete", "week")) %>% 
  select(-delete)
```

``` r
df %>% 
  mutate(week = as.double(week), 
         study_id = as.character(study_id)) %>% 
  group_by(arm, study_id) %>% 
  ggplot(aes(x = week, y = obs, color = arm, type = study_id)) + 
    geom_line() + 
  theme_bw() + 
  labs(title = "Trend in observations across weeks for each\n participant stratified by study arm",
       x = "Week", 
       y = "Observation") + 
  viridis::scale_color_viridis(name = "Study arm",
                               discrete = TRUE) + 
  theme(legend.position = "bottom", 
        legend.direction = "horizontal", 
        legend.box.spacing = unit(0.05, "cm"),
        plot.title = element_text(size = 11))
```

<img src="p8105_hw5_ntw2117_files/figure-markdown_github/spaghetti plot-1.png" width="75%" style="display: block; margin: auto;" />

### Problem 2

``` r
murder <- 
  read_csv("https://raw.githubusercontent.com/washingtonpost/data-homicides/master/homicide-data.csv") %>% 
  janitor::clean_names()
```

``` r
murder <- murder %>% 
  unite("city_state", c("city", "state"), sep = ", ")

unsolved <- murder %>% 
  group_by(city_state) %>% 
  filter(disposition %in% c("Closed without arrest", 
                            "Open/No arrest")) %>% 
  summarize(total_unsolved = n()) 
```

``` r
unsolved %>% 
  mutate(city_state = fct_reorder(city_state, total_unsolved)) %>% 
  ggplot(aes(x = city_state, y = total_unsolved)) + 
  geom_bar(stat = "identity", fill = "#A35E60") + 
  coord_flip() + 
  labs(title = "Number of unsolved homicides in 50 major US cities", 
       y = "Number of unsolved homicides", 
       x = "City") + 
  theme_bw() + 
  theme(plot.title = element_text(size = 12))
```

<img src="p8105_hw5_ntw2117_files/figure-markdown_github/unnamed-chunk-2-1.png" width="80%" style="display: block; margin: auto;" />
